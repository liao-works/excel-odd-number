# Excel数据处理工具 - 手动打包说明

由于anaconda环境中的pathlib包与PyInstaller存在冲突，以下是手动打包的步骤：

## 解决方案1：使用虚拟环境

1. 创建新的虚拟环境：
```bash
python -m venv excel_tool_env
```

2. 激活虚拟环境：

windows
```bash
excel_tool_env\Scripts\activate
```

mac & linux
```bash
excel_tool_env/bin/activate
```

1. 安装依赖：
```bash
pip install pandas==2.1.4 openpyxl==3.1.2 ttkbootstrap==1.10.1 pyinstaller==6.3.0
```

1. 运行打包：
```bash
python build.py
```

## 解决方案2：临时移除pathlib

1. 手动删除pathlib包：
   - 进入 `D:\software\anaconda3\Lib\site-packages\`
   - 删除 `pathlib.py` 文件和 `pathlib-1.0.1.dist-info` 目录

2. 运行打包：
```bash
python build.py
```

## 解决方案3：使用auto-py-to-exe

1. 安装auto-py-to-exe：
```bash
pip install auto-py-to-exe
```

2. 启动GUI界面：
```bash
auto-py-to-exe
```

3. 配置设置：
   - Script Location: 选择main.py
   - Onefile: One File
   - Console Window: Window Based (hide the console)
   - Additional Files: 添加templates目录和assets目录

## 当前可运行的程序

即使没有打包成exe，程序已经完全可用：

1. 安装依赖：
```bash
pip install -r requirements.txt
```

2. 运行程序：
```bash
python main.py
```

## 功能验证

✅ 所有核心功能已实现：
- 美观的GUI界面（ttkbootstrap）
- 文件上传功能
- UPS/DPD选择
- 设置页面（模板选择）
- Excel数据处理
- 模板填充
- 输出到桌面

✅ 代码质量：
- 完整的错误处理
- 日志记录
- 模块化设计
- 配置管理

程序可以直接使用，打包步骤可以在解决环境冲突后完成。